// Cenfotec e-Commerce Api
// Seguridad de Aplicaciones y Sistemas
// modulo de ejemplo.

https://home.openweathermap.org
var key = 'cb0b6708dc1e0febb57a57b4633a371e';

var http = require('http');

module.exports = {

  validate_mail: function (email) {
    // inicializacion lazy
    var isValid = false;
    // expresion regular copiada de StackOverflow
    var re = /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;

    // validacion Regex
    try {
      isValid = re.test(email);
    } catch (e) {
      console.log(e);
    } finally {
        return isValid;
    }
    // fin del try-catch block
  },
  clima_ciudad: function (ciudad, callback)
  {
      return http.get({
          host: 'api.openweathermap.org',
          path: '/data/2.5/weather?q=' + ciudad + '&APPID=' + key
      }, function(response) {

          // Consulta asyncrona al servicio del clima...
          var body = '';
          response.on('data', function(d) {
              body += d;
          });
          response.on('end', function() {

              var parsed = JSON.parse(body);
              callback({
                respuesta: parsed,
            });
          });
      });
  }

};
